<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Models for categorical data | MATH3091: Statistical Modelling II</title>
  <meta name="description" content="The course notes for MATH3091: Statistical Modelling II" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Models for categorical data | MATH3091: Statistical Modelling II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The course notes for MATH3091: Statistical Modelling II" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Models for categorical data | MATH3091: Statistical Modelling II" />
  
  <meta name="twitter:description" content="The course notes for MATH3091: Statistical Modelling II" />
  

<meta name="author" content="Dr Helen Ogden" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glm.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MATH3012: Statistical Modelling II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#elements-of-statistical-modelling"><i class="fa fa-check"></i><b>1.1</b> Elements of statistical modelling</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#regression-models"><i class="fa fa-check"></i><b>1.2</b> Regression Models</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#example-data-to-be-analysed"><i class="fa fa-check"></i><b>1.3</b> Example data to be analysed</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#nitric-nitric-acid"><i class="fa fa-check"></i><b>1.3.1</b> <code>nitric</code>: Nitric acid</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#birth-weight-of-newborn-babies"><i class="fa fa-check"></i><b>1.3.2</b> <code>birth</code>: Weight of newborn babies</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#survival-time-to-death"><i class="fa fa-check"></i><b>1.3.3</b> <code>survival</code>: Time to death</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#beetle-mortality-from-carbon-disulphide"><i class="fa fa-check"></i><b>1.3.4</b> <code>beetle</code>: Mortality from carbon disulphide</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#shuttle-challenger-disaster"><i class="fa fa-check"></i><b>1.3.5</b> <code>shuttle</code>: Challenger disaster</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#heart-treatment-for-heart-attack"><i class="fa fa-check"></i><b>1.3.6</b> <code>heart</code>: Treatment for heart attack</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#accident-road-traffic-accidents"><i class="fa fa-check"></i><b>1.3.7</b> <code>accident</code>: Road traffic accidents</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#lymphoma-lymphoma-patients"><i class="fa fa-check"></i><b>1.3.8</b> <code>lymphoma</code>: Lymphoma patients</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>2</b> Likelihood-based statistical inference</a><ul>
<li class="chapter" data-level="2.1" data-path="inference.html"><a href="inference.html#the-likelihood-function"><i class="fa fa-check"></i><b>2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="2.2" data-path="inference.html"><a href="inference.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>2.2</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="2.3" data-path="inference.html"><a href="inference.html#score"><i class="fa fa-check"></i><b>2.3</b> Score</a></li>
<li class="chapter" data-level="2.4" data-path="inference.html"><a href="inference.html#info"><i class="fa fa-check"></i><b>2.4</b> Information</a></li>
<li class="chapter" data-level="2.5" data-path="inference.html"><a href="inference.html#sn:asnmle"><i class="fa fa-check"></i><b>2.5</b> Asymptotic distribution of the MLE</a></li>
<li class="chapter" data-level="2.6" data-path="inference.html"><a href="inference.html#comparing-statistical-models"><i class="fa fa-check"></i><b>2.6</b> Comparing statistical models</a><ul>
<li class="chapter" data-level="2.6.1" data-path="inference.html"><a href="inference.html#introduction"><i class="fa fa-check"></i><b>2.6.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="inference.html"><a href="inference.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.7</b> Hypothesis testing</a></li>
<li class="chapter" data-level="2.8" data-path="inference.html"><a href="inference.html#sn:lrt"><i class="fa fa-check"></i><b>2.8</b> Likelihood ratio tests for nested hypotheses</a></li>
<li class="chapter" data-level="2.9" data-path="inference.html"><a href="inference.html#information-criteria-for-model-comparison"><i class="fa fa-check"></i><b>2.9</b> Information criteria for model comparison</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sn-lm.html"><a href="sn-lm.html"><i class="fa fa-check"></i><b>3</b> Linear Models</a><ul>
<li class="chapter" data-level="3.1" data-path="sn-lm.html"><a href="sn-lm.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="sn-lm.html"><a href="sn-lm.html#example-the-null-model"><i class="fa fa-check"></i>Example: The null model</a></li>
<li class="chapter" data-level="" data-path="sn-lm.html"><a href="sn-lm.html#example-simple-linear-regression"><i class="fa fa-check"></i>Example: simple linear regression</a></li>
<li class="chapter" data-level="" data-path="sn-lm.html"><a href="sn-lm.html#example-polynomial-regression"><i class="fa fa-check"></i>Example: Polynomial regression</a></li>
<li class="chapter" data-level="" data-path="sn-lm.html"><a href="sn-lm.html#example-multiple-regression"><i class="fa fa-check"></i>Example: Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sn-lm.html"><a href="sn-lm.html#maximum-likelihood-estimation-1"><i class="fa fa-check"></i><b>3.2</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="3.3" data-path="sn-lm.html"><a href="sn-lm.html#properties-of-the-mle"><i class="fa fa-check"></i><b>3.3</b> Properties of the MLE</a></li>
<li class="chapter" data-level="3.4" data-path="sn-lm.html"><a href="sn-lm.html#comparing-linear-models"><i class="fa fa-check"></i><b>3.4</b> Comparing linear models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>4</b> Generalised Linear Models</a><ul>
<li class="chapter" data-level="4.1" data-path="glm.html"><a href="glm.html#sn:ef"><i class="fa fa-check"></i><b>4.1</b> The Exponential family</a></li>
<li class="chapter" data-level="4.2" data-path="glm.html"><a href="glm.html#components-of-a-generalised-linear-model"><i class="fa fa-check"></i><b>4.2</b> Components of a generalised linear model</a><ul>
<li class="chapter" data-level="4.2.1" data-path="glm.html"><a href="glm.html#the-random-component"><i class="fa fa-check"></i><b>4.2.1</b> The random component</a></li>
<li class="chapter" data-level="4.2.2" data-path="glm.html"><a href="glm.html#the-systematic-or-structural-component"><i class="fa fa-check"></i><b>4.2.2</b> The systematic (or structural) component</a></li>
<li class="chapter" data-level="4.2.3" data-path="glm.html"><a href="glm.html#the-link-function"><i class="fa fa-check"></i><b>4.2.3</b> The link function</a></li>
<li class="chapter" data-level="4.2.4" data-path="glm.html"><a href="glm.html#the-linear-model"><i class="fa fa-check"></i><b>4.2.4</b> The linear model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="glm.html"><a href="glm.html#maximum-likelihood-estimation-2"><i class="fa fa-check"></i><b>4.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="4.4" data-path="glm.html"><a href="glm.html#sn:glminfer"><i class="fa fa-check"></i><b>4.4</b> Inference</a></li>
<li class="chapter" data-level="4.5" data-path="glm.html"><a href="glm.html#sn:compglm"><i class="fa fa-check"></i><b>4.5</b> Comparing generalised linear models</a><ul>
<li class="chapter" data-level="4.5.1" data-path="glm.html"><a href="glm.html#sn:glmlrt"><i class="fa fa-check"></i><b>4.5.1</b> The generalised likelihood ratio test</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="glm.html"><a href="glm.html#scaled-deviance-and-the-saturated-model"><i class="fa fa-check"></i><b>4.6</b> Scaled deviance and the saturated model</a></li>
<li class="chapter" data-level="4.7" data-path="glm.html"><a href="glm.html#sn:unknowndisp"><i class="fa fa-check"></i><b>4.7</b> Models with unknown <span class="math inline">\(a(\phi)\)</span></a></li>
<li class="chapter" data-level="4.8" data-path="glm.html"><a href="glm.html#residuals"><i class="fa fa-check"></i><b>4.8</b> Residuals</a></li>
<li class="chapter" data-level="4.9" data-path="glm.html"><a href="glm.html#example-binary-regression"><i class="fa fa-check"></i><b>4.9</b> Example: Binary Regression</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-categorical.html"><a href="chap-categorical.html"><i class="fa fa-check"></i><b>5</b> Models for categorical data</a><ul>
<li class="chapter" data-level="5.1" data-path="chap-categorical.html"><a href="chap-categorical.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="chap-categorical.html"><a href="chap-categorical.html#sn:multinomial"><i class="fa fa-check"></i><b>5.2</b> Multinomial sampling</a></li>
<li class="chapter" data-level="5.3" data-path="chap-categorical.html"><a href="chap-categorical.html#product-multinomial-sampling"><i class="fa fa-check"></i><b>5.3</b> Product multinomial sampling</a></li>
<li class="chapter" data-level="5.4" data-path="chap-categorical.html"><a href="chap-categorical.html#sn:loginter"><i class="fa fa-check"></i><b>5.4</b> Interpreting log-linear models</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH3091: Statistical Modelling II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\(
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\)
<div id="chap:categorical" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Models for categorical data</h1>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>A particularly important application of generalised linear models is the analysis of categorical data. Here, the data are observations of one or more categorical variables on each of a number of units (often individuals). Therefore, each of the units are <em>cross-classified</em> by the categorical variables.</p>
<p>For example, the <code>job</code> dataset gives the job satisfaction and income band of 901 individuals from the 1984 General Social Survey, which is summarised in Table .</p>

<p>A cross-classification table like this is called a <em>contingency table</em>. This is a <em>two-way table</em>, as there are two classifying variables. It might also be describe as a <span class="math inline">\(4\times 4\)</span> contingency table (as each of the classifying variables takes one of four possible levels).</p>
<p>Each position in a contingency table is called a <em>cell</em> and the number of individuals in a particular cell is the <em>cell count</em>.</p>
<p>Partial classifications derived from the table are called <em>margins</em>. For a two-way table these are often displayed in the margins of the table, as in Table . These are one-way margins as they represent the classification of items by a single variable; income group and job satisfaction respectively.</p>

<p>The <code>lymphoma</code> dataset gives information about 30 patients, classified by cell type of lymphoma, sex, and response to treatment, as shown in Table . This is an example of a three-way contingency table. It is a <span class="math inline">\(2\times 2\times 2\)</span> or <span class="math inline">\(2^3\)</span> table.</p>

<p>For <em>multiway</em> tables, higher order margins may be calculated. For example, for <code>lymphoma</code>, the two-way Cell type/Sex margin is shown in Table .</p>

<p>We can model contingency table data using generalised linear models. To do this, we assume that the cell counts are observations of independent Poisson random variables. This is intuitively sensible as the cell counts are non-negative integers (the sample space for the Poisson distribution). Therefore, if the table has <span class="math inline">\(n\)</span> cells, which we label <span class="math inline">\(1,\ldots ,n\)</span>, then the observed cell counts <span class="math inline">\(y_1,\ldots ,y_n\)</span> are assumed to be observations of independent Poisson random variables <span class="math inline">\(Y_1,\ldots ,Y_n\)</span>. We denote the means of these Poisson random variables by <span class="math inline">\(\mu_1,\ldots ,\mu_n\)</span>. The canonical link function for the Poisson distribution is the log function, and we assume this link function throughout. A generalised linear model for Poisson data using the log link function is called a <em>log-linear model</em>.</p>
<p>The explanatory variables in a log-linear model for contingency table data are the cross-classifying variables. As these variables are categorical, they are <em>factors</em>. As usual with factors, we can include interactions in the model as well as just main effects. Such a model will describe how the expected count in each cell depends on the classifying variables, and any interactions between them. Interpretation of these models will be discussed further in Section <a href="chap-categorical.html#sn:loginter">5.4</a>.</p>
<p>Table  shows the original data structure of the <code>job</code> dataset. It provides exactly the same data as the contingency table in Table , but in a different format, sometimes called <em>long</em> format. A log-linear model is just a Poisson GLM, where the response variable is <code>Count</code>, and <code>Income</code> and <code>Satisfaction</code> are explanatory variables.</p>

<p>Table  shows the <code>lymphoma</code> dataset in long format. Again, a log-linear model for the contingency table (Table ) is just a Poisson GLM for this data, where in this case the response variable is <code>Cell</code>, and <code>Sex</code> and <code>Remis</code> are explanatory variables.</p>

</div>
<div id="sn:multinomial" class="section level2">
<h2><span class="header-section-number">5.2</span> Multinomial sampling</h2>
<p>Although the assumption of Poisson distributed observations is convenient for the purposes of modelling, it might not be a realistic assumption, because of the way in which the data have been collected. Frequently, when contingency table data are obtained, the total number of observations (the <em>grand total</em>, the sum of all the cell counts) is fixed in advance. In this case, no individual cell count can exceed the prespecified fixed total, so the assumption of Poisson sampling is invalid as the sample space is bounded. Furthermore, with a fixed total, the observations can no longer be observations of independent random variables.</p>
<p>For example, consider the <code>lymphoma</code> contingency table from Table . It may be that these data were collected over a fixed period of time, and that in that time there happened to be 30 patients. In this case, the Poisson assumption is perfectly valid. However, it may have been decided at the outset to collect data on 30 patients, in which case the grand total is fixed at 30, and the Poisson assumption is not valid.</p>
When the grand total is fixed, a more appropriate distribution for the cell counts is the <em>multinomial</em> distribution. The multinomial distribution is the distribution of cell counts arising when a prespecified total of <span class="math inline">\(N\)</span> items are each independently assigned to one of <span class="math inline">\(n\)</span> cells, where the probability of being classified into cell <span class="math inline">\(i\)</span> is <span class="math inline">\(p_i\)</span>, <span class="math inline">\({i=1,\ldots ,n}\)</span>, so <span class="math inline">\(\sum_{i=1}^n p_i=1.\)</span> The probability function for the multinomial distribution is
<span class="math display" id="eq:multinom">\[\begin{align}
f_{\bm{Y}}(\bm{y};{\bf p})
&amp;= P(Y_1=y_1,\ldots ,Y_n=y_n) \cr
&amp;= \begin{cases} 
N!\prod_{i=1}^n \frac{p_i^{y_i}}{y_i!} &amp; \text{if $\sum_{i=1}^n y_i=N$} \\
0 &amp; \text{otherwise.}
\end{cases}
\tag{5.1}
\end{align}\]</span>
<p>The binomial is the special case of the multinomial with two cells (<span class="math inline">\(n=2\)</span>).</p>
<p>We can still use a log-linear model for contingency table data when the data have been obtained by multinomial sampling. We model <span class="math inline">\(\log\mu_i=\log(Np_i)\)</span>, <span class="math inline">\({i=1,\ldots ,n}\)</span> as a linear function of explanatory variables. However, such a model must preserve <span class="math inline">\(\sum_{i=1}^n \mu_i=N\)</span>, the grand total which is fixed in advance.</p>
<p>From <a href="chap-categorical.html#eq:multinom">(5.1)</a>, the log-likelihood for a multinomial log-linear model is <span class="math display">\[
\ell(\bm{\mu})=
\sum_{i=1}^n y_i\log\mu_i -N\log N -\sum_{i=1}^n \log y_i!+\log N!.
\]</span> Therefore, the maximum likelihood estimates <span class="math inline">\(\hat{\bm{\mu}}\)</span> maximise <span class="math inline">\(\sum_{i=1}^n y_i\log\mu_i\)</span> subject to the constraints <span class="math inline">\(\sum_{i=1}^n \mu_i=N=\sum_{i=1}^n y_i\)</span> (multinomial sampling) and <span class="math inline">\(\log\bm{\mu}=\bm{X}\bm{\beta}\)</span> (imposed by the model).</p>
For a Poisson log-linear model, <span class="math display">\[
L(\bm{\mu})=\prod_{i=1}^n {{e^{-\mu_i} \mu_i^{y_i}}\over{y_i!}}.
\]</span> Therefore,
<span class="math display" id="eq:loglinlik">\[\begin{align}
\ell(\bm{\mu})&amp;=-\sum_{i=1}^n \mu_i
+\sum_{i=1}^ny_i\log\mu_i-\sum_{i=1}^n \log y_i! 
\tag{5.2}
\\
&amp;=-\sum_{i=1}^n \exp(\log\mu_i)
+\sum_{i=1}^ny_i\log\mu_i-\sum_{i=1}^n \log y_i!.
\end{align}\]</span>
Now any Poisson log-linear model with an intercept can be expressed as <span class="math display">\[
\log\mu_i=\alpha + \text{other terms depending on $i$},\qquad {i=1,\ldots ,n}
\]</span> so that
<span class="math display" id="eq:loglinscore">\[\begin{align}
&amp;\qquad{\partial\over{\partial\alpha}} \ell(\bm{\mu})=-\sum_{i=1}^n \exp(\log\mu_i)
+\sum_{i=1}^ny_i. \\
&amp;\Rightarrow\qquad \sum_{i=1}^n \hat{\mu}_i=\sum_{i=1}^n y_i.
\tag{5.3}
\end{align}\]</span>
<p>From <a href="chap-categorical.html#eq:loglinlik">(5.2)</a>, we notice that, at <span class="math inline">\(\alpha=\hat{\alpha}\)</span> the log-likelihood takes the form <span class="math display">\[
\ell(\bm{\mu})=-\sum_{i=1}^n y_i
+\sum_{i=1}^ny_i\log{\mu}_i-\sum_{i=1}^n \log y_i!.
\]</span> Hence, when we maximise the log-likelihood, for a Poisson log-linear model with intercept, with respect to the other log-linear parameters, we are maximising <span class="math inline">\(\sum_{i=1}^ny_i\log{\mu}_i\)</span> subject to the constraints <span class="math inline">\(\sum_{i=1}^n \mu_i=\sum_{i=1}^n y_i\)</span> from <a href="chap-categorical.html#eq:loglinscore">(5.3)</a> and <span class="math inline">\(\log\bm{\mu}=\bm{X}\bm{\beta}\)</span> (imposed by the model).</p>
<p>Therefore, the maximum likelihood estimates for multinomial log-linear parameters are identical to those for Poisson log-linear parameters. Furthermore, the maximised log-likelihoods for both Poisson and multinomial models take the form <span class="math inline">\(\sum_{i=1}^ny_i\log\hat{\mu}_i\)</span> as functions of the log-linear parameter estimates. Therefore any inferences based on maximised log-likelihoods (such as likelihood ratio tests) will be the same.</p>
<p>Therefore, we can analyse contingency table data using Poisson log-linear models, even when the data has been obtained by multinomial sampling. All that is required is that we ensure that the Poisson model contains an intercept term.</p>
</div>
<div id="product-multinomial-sampling" class="section level2">
<h2><span class="header-section-number">5.3</span> Product multinomial sampling</h2>
<p>Sometimes margins other than just the grand total may be prespecified. For example, consider the <code>lymphoma</code> contingency table in Table . It may have been decided at the outset to collect data on 18 male patients and 12 female patients. Alternatively, perhaps the distribution of both the Sex and Cell type of the patients was fixed in advance as in Table . In cases where a margin is fixed by design, the data consist of a number of fixed total subgroups, defined by the fixed margin. Neither Poisson nor multinomial sampling assumptions are valid. The appropriate distribution combines a separate, independent multinomial for each subgroup. For example, if just the Sex margin is fixed as above, then the appropriate distribution for modelling the data is two independent multinomials, one for males with <span class="math inline">\(N=18\)</span> and one for females with <span class="math inline">\(N=12\)</span>. Each of these multinomials has four cells, representing the cross-classification of the relevant patients by Cell Type and Remission. Alternatively, if it is the Cell type/Sex margin which has been fixed, then the appropriate distribution is four independent two-cell multinomials (binomials) representing the remission classification for each of the four fixed-total patient subgroups.</p>
<p>When the data are modelled using independent multinomials, then the joint distribution of the cell counts <span class="math inline">\(Y_1, \ldots, Y_n\)</span> is the product of terms of the same form as <a href="chap-categorical.html#eq:multinom">(5.1)</a>, one for each fixed-total subgroup. We call this a distribution a <em>product multinomial</em>. Each subgroup has its own fixed total. The full joint density is a product of <span class="math inline">\(n\)</span> terms, as before, with each cell count appearing exactly once.</p>
<p>For example, if the Sex margin is fixed for <code>lymphoma</code>, then the product multinomial distribution has the form <span class="math display">\[f_{\bm{Y}}(\bm{y};{\bf p})=
\begin{cases}
N_m!\prod_{i=1}^4 {{p_{mi}^{y_{mi}}}\over{y_{mi}!}}
N_f!\prod_{i=1}^4 {{p_{fi}^{y_{fi}}}\over{y_{fi}!}} &amp;
\text{if $\sum_{i=1}^4 y_{mi}=N_m$ and
$\sum_{i=1}^4 y_{fi}=N_f$} \\
0 &amp; \text{otherwise,}
\end{cases}
\]</span> where <span class="math inline">\(N_m\)</span> and <span class="math inline">\(N_f\)</span> are the two fixed marginal totals (18 and 12 respectively), <span class="math inline">\(y_{m1},\ldots ,y_{m4}\)</span> are the cell counts for the Cell type/Remission cross-classification for males and <span class="math inline">\(y_{f1},\ldots ,y_{f4}\)</span> are the corresponding cell counts for females. Here <span class="math inline">\(\sum_{i=1}^4 p_{mi}=\sum_{i=1}^4 p_{fi}=1\)</span>, <span class="math inline">\(E(Y_{mi})=N_mp_{mi}\)</span>, <span class="math inline">\(i=1,\ldots ,4\)</span>, and <span class="math inline">\(E(Y_{fi})=N_fp_{fi}\)</span>, <span class="math inline">\(i=1,\ldots ,4\)</span>.</p>
<p>Using similar results to those used in Section <a href="chap-categorical.html#sn:multinomial">5.2</a> (but not proved here), we can analyse contingency table data using Poisson log-linear models, even when the data has been obtained by product multinomial sampling. However, we must ensure that the Poisson model contains a term corresponding to the fixed margin (and all marginal terms). Then, the estimated means for the specified margin are equal to the corresponding fixed totals.</p>
<p>For example, for the <code>lymphoma</code> dataset, for inferences obtained using a Poisson model to be valid when the Sex margin is fixed in advance, the Poisson model must contain the Sex main effect (and the intercept). For inferences obtained using a Poisson model to be valid when the Cell type/Sex margin is fixed in advance, the Poisson model must contain the Cell type/Sex interaction, and all marginal terms (the Cell type main effect, the Sex main effect and the intercept).</p>
<p>Therefore, when analysing product multinomial data using a Poisson log-linear model, certain terms <strong>must</strong> be present in any model we fit. If they are removed, the inferences would no longer be valid.</p>
</div>
<div id="sn:loginter" class="section level2">
<h2><span class="header-section-number">5.4</span> Interpreting log-linear models</h2>
<p>Log-linear models for contingency tables enable us to determine important properties concerning the joint distribution of the classifying variables. In particular, the form of our preferred log linear model for a table will have implications for how the variables are associated.</p>
<p>Each combination of the classifying variables occurs exactly once in a contingency table. Therefore, the model with the highest order interaction (between all the variables) and all marginal terms (all other interactions) is the saturated model. The implication of this model is that every combination of levels of the variables has its own mean (probability) and that there are no relationships between these means (no structure). The variables are highly dependent.</p>
To consider the implications of simpler models, we first consider a two-way <span class="math inline">\(r\times c\)</span> table where the two classifying variables <span class="math inline">\(R\)</span> and <span class="math inline">\(C\)</span> have <span class="math inline">\(r\)</span> and <span class="math inline">\(c\)</span> levels respectively. The saturated model <span class="math inline">\(R*C\)</span> implies that the two variables are associated. If we remove the RC interaction, we have the model <span class="math inline">\(R+C\)</span>, <span class="math display">\[
\log\mu_i=\alpha+\beta_R(r_i)+\beta_C(c_i),\qquad{i=1,\ldots ,n}
\]</span> where <span class="math inline">\(n=rc\)</span> is the total number of cells in the table. Because of the equivalence of Poisson and multinomial sampling, we can think of each cell mean <span class="math inline">\(\mu_i\)</span> as equal to <span class="math inline">\(Np_i\)</span> where <span class="math inline">\(N\)</span> is the total number of observations in the table, and <span class="math inline">\(p_i\)</span> is a cell probability. As each combination of levels of <span class="math inline">\(R\)</span> and <span class="math inline">\(C\)</span> is represented in exactly one cell, it is also convenient to replace the cell label <span class="math inline">\(i\)</span> by the pair of labels <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span> representing the corresponding levels of <span class="math inline">\(R\)</span> and <span class="math inline">\(C\)</span> respectively. Hence <span class="math display">\[
\log p_{jk}=\alpha+\beta_R(j)+\beta_C(k)-\log N, \quad j=1,\ldots ,r,\quad
k=1,\ldots ,c.
\]</span> Therefore <span class="math display">\[P(R=j,C=k)=\exp[\alpha+\beta_R(j)+\beta_C(k)-\log N], \quad j=1,\ldots ,r,\quad
k=1,\ldots ,c,\]</span> so
<span class="math display">\[\begin{align*}
1&amp;=\sum_{j=1}^r\sum_{k=1}^c\exp[\alpha+\beta_R(j)+\beta_C(k)-\log N]\cr
&amp;={1\over N}\exp[\alpha]\sum_{j=1}^r\exp[\beta_R(j)]\sum_{k=1}^c\exp[\beta_C(k)].
\end{align*}\]</span>
Furthermore
<span class="math display">\[\begin{align*}
P(R=j)&amp;=\sum_{k=1}^c\exp[\alpha+\beta_R(j)+\beta_C(k)-\log N]\cr
&amp;={1\over N}\exp[\alpha]\exp[\beta_R(j)]\sum_{k=1}^c\exp[\beta_C(k)],
\quad j=1,\ldots,r,
\end{align*}\]</span>
and
<span class="math display">\[\begin{align*}
P(C=k)&amp;=\sum_{j=1}^r\exp[\alpha+\beta_R(j)+\beta_C(k)-\log N]\cr
&amp;={1\over N}\exp[\alpha]\exp[\beta_C(k)]\sum_{j=1}^r\exp[\beta_R(j)],
\quad k=1,\ldots,c.
\end{align*}\]</span>
Therefore
<span class="math display">\[\begin{align*}
P(R=j)P(C=k)&amp;=
{1\over N}\exp[\alpha]\exp[\beta_C(k)]\exp[\beta_R(j)]\times 1\cr
&amp;=P(R=j,C=k), \quad j=1,\ldots ,r,\quad
k=1,\ldots ,c.
\end{align*}\]</span>
<p>Absence of the interaction <span class="math inline">\(R*C\)</span> in a log-linear model implies that <span class="math inline">\(R\)</span> and <span class="math inline">\(C\)</span> are independent variables. Absence of main effects is generally less interesting, and main effects are typically not removed from a log-linear model.</p>
<p>In multiway tables, absence of a two-factor interaction does not necessarily mean that the two variables are independent. For example, consider the <code>lymphoma</code> dataset, with 3 binary classifying variables Sex (<span class="math inline">\(S\)</span>), Cell type (<span class="math inline">\(C\)</span>) and Remission (<span class="math inline">\(R\)</span>). After comparing the fit of several possible models, we find that a reasonable log-linear model for these data is <span class="math inline">\(R * C + C * S\)</span>. Hence the interaction between remission and sex is absent. The fitted cell probabilities from this log-linear model are shown in Table .</p>

<p>The estimated probabilities for the two-way Sex/Remission margin (together with the corresponding one-way margins) are shown in Table .</p>

<p>It can immediately be seen that this model does not imply independence of <span class="math inline">\(R\)</span> and <span class="math inline">\(S\)</span>, as <span class="math inline">\(\hat{P}(R,S)\ne\hat{P}(R)\hat{P}(S)\)</span>. What the model <span class="math inline">\(R*C+C*S\)</span> implies is that <span class="math inline">\(R\)</span> is independent of <span class="math inline">\(S\)</span> <em>conditional on</em> <span class="math inline">\(C\)</span>, that is <span class="math display">\[
P(R,S|C)=P(R|C)P(S|C).
\]</span> Another way of expressing this is <span class="math display">\[
P(R|S,C)=P(R|C),
\]</span> that is, the probability of each level of <span class="math inline">\(R\)</span> given a particular combination of <span class="math inline">\(S\)</span> and <span class="math inline">\(C\)</span>, does not depend on which level <span class="math inline">\(S\)</span> takes. Table  shows the estimated conditional probabilities for the <code>lymphoma</code> data. The probability of remission depends only on a patient’s cell type, and not on their sex.</p>

<p>In general, if we have an <span class="math inline">\(r\)</span>-way contingency table with classifying variables <span class="math inline">\(X_1,\ldots ,X_r\)</span>, then a log linear model which does not contain the <span class="math inline">\(X_1 * X_2\)</span> interaction (and therefore by the principle of marginality contains no interaction involving both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>) implies that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are <em>conditionally independent</em> given <span class="math inline">\(X_3,\ldots ,X_r\)</span>, that is <span class="math display">\[
P(X_1,X_2|X_3,\ldots ,X_r)=P(X_1|X_3,\ldots ,X_r)P(X_2|X_3,\ldots ,X_r).
\]</span> The proof of this is similar to the proof in the two-way case. Again, an alternative way of expressing conditional independence is <span class="math display">\[
P(X_1|X_2,X_3,\ldots ,X_r)=P(X_1|X_3,\ldots ,X_r)
\]</span> or <span class="math display">\[
P(X_2|X_1,X_3,\ldots ,X_r)=P(X_2|X_3,\ldots ,X_r).
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_no_m &lt;-<span class="st"> </span>lymphoma_p_margins[, <span class="dv">1</span>]
p_yes_m &lt;-<span class="st"> </span>lymphoma_p_margins[, <span class="dv">2</span>]
p_yes_m<span class="op">/</span>(p_yes_m <span class="op">+</span><span class="st"> </span>p_no_m)</code></pre></div>
<pre><code>##    Female      Male       Sum 
## 0.5520362 0.2986425 0.4000000</code></pre>
<p>Although for the <code>lymphoma</code> dataset <span class="math inline">\(R\)</span> and <span class="math inline">\(S\)</span> are conditionally independent given <span class="math inline">\(C\)</span>, they are not marginally independent. Using the marginal cell probabilities from Table , we find that the probability of remission is <span class="math inline">\(0.30\)</span> for men and <span class="math inline">\(0.55\)</span> for women. Male patients have a much lower probability of remission. The reason for this is that, although <span class="math inline">\(R\)</span> and <span class="math inline">\(S\)</span> are not directly associated, they are both associated with <span class="math inline">\(C\)</span>. Observing the estimated values it is clear that patients with nodular cell type have a greater probability of remission, and furthermore, that female patients are more likely to have this cell type than males. Hence women are more likely to have remission than men.</p>
<p>Suppose the factors for a three-way tables are <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span>. We can list all possible models and the implications for the conditional independence structure:</p>
<ol style="list-style-type: decimal">
<li>Model 1 containing the terms <span class="math inline">\(X_1, X_2, X_3\)</span>. All factors are mutually independent.</li>
<li>Model 2 containing the terms <span class="math inline">\(X_1*X_2, X_3\)</span>. The factor <span class="math inline">\(X_3\)</span> is jointly independent of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</li>
<li>Model 3 containing the terms <span class="math inline">\(X_1*X_2, X_2*X_3\)</span>. The factors <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_3\)</span> are conditionally independent given <span class="math inline">\(X_2\)</span>.</li>
<li>Model 4 containing the terms <span class="math inline">\(X_1*X_2, X_2*X_3, X_1*X_3\)</span>. There is no conditional independence structure. This is the model without the highest order interaction term.</li>
<li>Model 5 containing <span class="math inline">\(X_1*X_2*X_3\)</span>. This is the saturated model. No more simplification of dependence structure is possible.</li>
</ol>
<p>Conditional and marginal association of two variables can therefore often appear somewhat different. Sometimes, the association can be ‘reversed’ so that what looks like a positive association marginally, becomes a negative association conditionally. This is known as <em>Simpson’s paradox</em>.</p>
<p>In 1972-74, a survey of women was carried out in an area of Newcastle. A follow-up survey was carried out 20 years later. Among the variables observed in the initial survey was whether or not the individual was a smoker and among those in the follow-up survey was whether the individual was still alive, or had died in the intervening period. A summary of the responses is shown in Table .</p>

<p>Looking at this table, it appears that the non-smokers had a greater probability of dying. However, there is an important extra variable to be considered, related to both smoking habit and mortality – age (at the time of the initial survey). When we consider this variable, we get Table . Conditional on every age at outset, it is now the smokers who have a higher probability of dying. The marginal association is reversed in the table conditional on age, because mortality (obviously) and smoking are associated with age. There are proportionally many fewer smokers in the older age-groups (where the probability of death is greater).</p>

<p>When making inferences about associations between variables, it is important that all other variables which are relevant are considered. Marginal inferences may lead to misleading conclusions.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/heogden/math3091/edit/master/categorical.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["MATH3091.pdf", "MATH3091.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
